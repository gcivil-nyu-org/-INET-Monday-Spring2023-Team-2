{% extends 'base.html' %}
{% load static %}
{% block content %}
{% if user.is_organization %}
    <!-- Sidenav -->
    <div class="sidenav">
        <div class="profile">
            <img src="{% static organization.organization_image %}" alt="" width="100" height="100"/>
            <div class="name">
                {{ organization.name }}
            </div>
        </div>
        <div class="sidenav-url">
            <div class="url">
                <a href="{% url 'post_an_opportunity' %}" class="active">POST AN OPPORTUNITY</a>
                <hr align="center">
            </div>
            <div class="url">
                <a href="#settings">IMPACT</a>
                <hr align="center">
            </div>
        </div>
    </div>
    <!-- End -->

    <!-- Main -->
    <div class="main">
        <h2>OPPORTUNITY DETAILS</h2>
        <div class="card">
            <div class="card-body">
                <form method="post" class="edit-form" 
                id="opportunity_form" 
                data-subcat-url="{% url 'ajax_load_subcategories' %}" 
                data-subsubcat-url="{% url 'ajax_load_subsubcategories' %}" 
                action="{% url 'post_an_opportunity' %}">
                    {% csrf_token %}
                    {{ opportunity_form.as_p }}
                    <button type="submit" id="edit-form-edit-btn" class="edit-form">Post</button>
                </form>
                
                <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
                <script>

                $("#id_category").change(function () {

                    var url = $("#opportunity_form").attr("data-subcat-url");  
                    var categoryId = $(this).val();  
                    $.ajax({                      
                      url: url,                    
                      data: {
                        'category': categoryId       
                      },
                      success: function (data) {   
                        $("#id_subcategory").html(data);
                        $("#id_subsubcategory").html(data);

                      }
                    });
              
                  });

                $("#id_subcategory").change(function () {

                    var url = $("#opportunity_form").attr("data-subsubcat-url");  
                    var subcategoryId = $(this).val();  
                    $.ajax({                       
                      url: url,                    
                      data: {
                        'subcategory': subcategoryId       
                      },
                      success: function (data) {   
                        $("#id_subsubcategory").html(data);  
                      }
                    });
              
                  });
                </script>
            </div>
        </div>
    </div>
    {% endif %}
{% endblock %}